{% extends 'layout/base.html' %}

{% block 'title' %} Clientes {% endblock %}

{% block 'style' %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/estiloindex.css' %}">
<link rel="stylesheet" href="{% static 'css/estilo.css' %}">
{% endblock %}

{% block 'header' %}
{% include 'layout/partials/headerbase.html' %}
{% endblock %}

{% block 'content' %}
<div class="left-menu">
  <div class="caja 1">
    {% include 'layout/partials/leftmenu.html' %}
  </div>
    <div class="column-2">
    <div class="column-2-1" style="flex-grow:0;">
        <div class="table table-dark">
            <form action="" method="POST" class="form">
            <a href=" {% url 'registerClient' %}" class="btn btn-info" style="margin-left:100px;">Crear Cliente</a>
            <a href=" {% url 'registerPet' %}" class="btn btn-info" style="margin-left:100px;">Crear Mascota</a>

            
                {% csrf_token %}
                    <label style="margin-left:200px;">BUSCAR CLIENTES</label>
                    <input type="text" class="form-control-sm " style="margin-left:10px;" name="search">
                    <input type="submit" class="btn btn-secondary" value="Buscar" style="margin-left:10px;">    
                </form>
        </div>
    </div>
    <div class="column-2-2">
            <table class="table table-dark">
                {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
                <tr>
                    <th>Nombre</th>
                    <th>Apellidos</th>
                    <th>Identificacion</th>
                    <th>Email</th>
                    <th>Telefono</th>
                    <th></th>
                    <th></th>
                </tr>
            {% for client in clients %}
                <tr>
                    <th>{{client.name}}</th>
                    <th>{{client.last_name}}</th>
                    <th>{{client.identification}}</th>
                    <th>{{client.email}}</th>
                    <th>{{client.phone}}</th>
                    <th><a href="{% url 'updateClient' id=client.id %}" class="btn btn-primary">Actualizar perfil</a></th> 
                    <th><button onclick = "borrar('{{client.id}}')" class="btn btn-danger">Eliminar</button></th> 

                </tr>
            {% endfor %}
            </table>
    </div>
    </div>
</div>
{% endblock %}

{% block 'script' %}
<script>
    function borrar(id){
        swal({
            title : 'Esta seguro que desea borrar ?',
            text : 'Si lo borras no podras recuperarlo',
            icon : 'warning',
            buttons : true ,
            dangerMode : true ,
        })
        .then ((willDelete)=>{
            if (willDelete){
                location.href = "/eliminar/clientes/"+id
            }
            else{
                swal ('No se borro el registro')
            }
        });
    }
</script>
{% endblock  %}