{% extends 'layout/base.html' %}

{% block 'title' %} Registro Citas{% endblock %}

{% block 'style' %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/estilo.css' %}">
<link rel="stylesheet" href="{% static 'fullcalendar/lib/main.css' %}">
<script src={% static 'fullcalendar/lib/locales/es.js' %}></script> 
{% endblock %}

{% block 'header' %}
{% include 'layout/partials/headerbase.html' %}
{% endblock %}

{% block 'content' %}
{% if form.instance %}
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">Actualizar Cita</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
        <form method="post" id="update-form">
          {% csrf_token %}
          {{ form.as_p }}
          <input type="submit" value="Actualizar">
        </form>
      </div>
    </div>
  </div>
</div>
{% endif %}

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<div class="container-fluid" style="background-color: #181818;">
  <div class="row">
    <div class="col-md-12" style="background-color: #181818; height: 100vh;">
      <div id="calendar" class="container bg-dark" style="padding: 25px; color: white;">
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block 'script' %}

<script src="{% static 'fullcalendar/lib/main.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  var calendarUI = document.getElementById('calendar');;
  var calendar = new FullCalendar.Calendar(calendarUI, {
      initialView: 'listWeek',
      editable:false,
      headerToolbar: {
        start: 'prev,next today',
        center: 'title',
        end: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'},
      views: {
        timeGrid: {
          buttonText: 'Día'
        },
        dayGridMonth: {
          buttonText: 'Mes'
        },
        timeGridWeek: {
          buttonText: 'Semana'
        },
        timeGridDay: {
          buttonText: 'Día'
        },
        listMonth: {
          buttonText: 'Lista'
        }},
      locale: 'es',
      events: [
      {%for event in events %}
      {
          title: "{{event.title}}",
          start: "{{event.start}}",
          url: "#",
      },
      {% endfor %}
          ]
      });
calendar.render();
{% if form.instance %}
  $("#myModal").modal("show");
{% endif %}
});
</script>
{% endblock  %}

